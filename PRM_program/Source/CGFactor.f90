	SUBROUTINE CGFactor(J1,J2,J3,M1,M2,M3,CGResult)
	DOUBLE PRECISION :: J1, M1, J2, M2, J3, M3, CGResult
	COMMON/LNFJ/ SLNI(164),SLNF(164),SLNJ(164)
	CALL SLNN		
	! IF(J1.EQ.0.D0.AND.J2.EQ.0.D0.AND.J3.EQ.0.D0.AND.M1.EQ.0.D0.AND.M2.EQ.0.D0.AND.M3.EQ.0.D0) GOTO 888	
    CGResult=S3J(J1,J2,J3,M1,M2,M3)
! 888 STOP
	END SUBROUTINE CGFactor

! C        2.00   2.00   4.00    .00    .00    .00
! C     3J=   .2390457E+00
! C        1.00   1.00    .00   1.00  -1.00    .00
! C     3J=   .5773503E+00
! C        3.00   2.00   1.00   1.00  -2.00   1.00
! C     3J=   .9759001E-01
! C        2.50   2.00    .50   1.50  -2.00    .50
! C     3J=   .1825742E+00
! C        2.00   2.00   1.00   1.00  -2.00   1.00
! C     3J=  -.2581989E+00
	
	FUNCTION S3J(XJ1,XJ2,XJ3,XM1,XM2,XM3)
	IMPLICIT DOUBLE PRECISION(A-H,O-Z)
	COMMON/LNFJ/ SLNI(164),SLNF(164),SLNJ(164)
	IF (DABS(XM1).GT.XJ1.OR.DABS(XM2).GT.XJ2.OR.DABS(XM3).GT.XJ3) GOTO 10	
	M=IFX(XM1+XM2-XM3)
	! JM=IFX(XJ1-XJ2-XM3)
	J12=IFX(XJ1+XJ2-XJ3)
	J13=IFX(XJ1-XJ2+XJ3)
	J23=IFX(-XJ1+XJ2+XJ3)
	J=IFX(XJ1+XJ2+XJ3)
	JM11=IFX(XJ1+XM1)
	JM12=IFX(XJ1-XM1)
	JM21=IFX(XJ2+XM2)
	JM22=IFX(XJ2-XM2)
	JM31=IFX(XJ3+XM3)
	JM32=IFX(XJ3-XM3)
	MJ32=IFX(XJ3-XJ2+XM1)
	MJ31=IFX(XJ3-XJ1-XM2)
	IF(M.NE.0. .OR. J12.LT.0. .OR. J13.LT.0. .OR. J23.LT.0.) GOTO 10
	A=SLNF(J12+1)+SLNF(J13+1)+SLNF(J23+1)+SLNF(JM11+1) &
    +SLNF(JM12+1)+SLNF(JM21+1)+SLNF(JM22+1)+SLNF(JM31+1)+SLNF(JM32+1)-SLNF(J+2)	
	A=DEXP(A)
	A=DSQRT(A)
	B=0.0D0
	DO 1 K=0,10000
	IF(J12-K.LT.0. .OR. JM12-K.LT.0. .OR. JM21-K.LT.0. .OR. MJ32+K.LT.0. .OR. MJ31+K.LT.0.) GOTO 1
    B0=-SLNF(K+1)-SLNF(J12-K+1)-SLNF(JM12-K+1) &
    -SLNF(JM21-K+1)-SLNF(MJ32+K+1)-SLNF(MJ31+K+1)
    IF(DABS(B0).LT.0.1E-40) GOTO 1
    B0=DEXP(B0)
	IF(K.EQ.0) CK=1.D0
	IF(K.NE.0) CK=(-1.D0)**K
	B=B+CK*B0
1	CONTINUE
	! IF(JM.EQ.0) CC=1.D0
	! IF(JM.NE.0) CC=(-1.D0)**JM
	S3J=A*B	
	S3J=S3J*SQRT(2*XJ3+1)
	GOTO 20
10	S3J=0.0D0
20	CONTINUE
	!WRITE(2,2) XJ1,XJ2,XJ3,XM1,XM2,XM3,S3J
	!WRITE(*,2) XJ1,XJ2,XJ3,XM1,XM2,XM3,S3J
2	FORMAT(2X,6F7.2,/,2X,'3J=',E15.7)	
	RETURN
	END	FUNCTION S3J
 
	SUBROUTINE SLNN
	IMPLICIT DOUBLE PRECISION(A-H,O-Z)
	COMMON/LNFJ/ SLNI(164),SLNF(164),SLNJ(164)
	DO 1 N=2,164
1	SLNI(N)=DLOG(DBLE(FLOAT(N-1)))
	SLNI(1)=0.0D0	
	FLN=1.0D0
	DO 2 N=2,164
	FLN=FLN*DBLE(FLOAT(N-1))
2	SLNF(N)=DLOG(FLN)
	SLNF(1)=0.0D0
	FLN=1.0D0
	DO 3 N=1,163,2
	FLN=FLN*DBLE(FLOAT(N))
3	SLNJ(N+1)=DLOG(FLN)
	FLN=1.0D0
	DO 4 N=2,162,2
	FLN=FLN*DBLE(FLOAT(N))
4	SLNJ(N+1)=DLOG(FLN)
	SLNJ(1)=0.0D0
	RETURN
	END SUBROUTINE SLNN

	FUNCTION IFX(X)
	IMPLICIT DOUBLE PRECISION(A-H,O-Z)
	A=SNGL(X-0.001D0)
	B=SNGL(X+0.001D0)
	IF(X.LT.0.0D0) IFX=IFIX(REAL(A))
	IF(X.GT.0.0D0) IFX=IFIX(REAL(B))
	IF(X.EQ.0.0D0) IFX=0
	RETURN
	END FUNCTION IFX